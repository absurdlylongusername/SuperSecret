@page
@model SuperSecret.Pages.Admin.IndexModel

<form method="post">
    <div asp-validation-summary="ModelOnly"></div>

    <label asp-for="Input.Username"></label>
    <input asp-for="Input.Username" />
    <span asp-validation-for="Input.Username"></span>
    <br /><br />

    <label asp-for="Input.Max"></label>
    <input asp-for="Input.Max" type="number" />
    <span asp-validation-for="Input.Max"></span>
    <br /><br />

    <label asp-for="Input.ExpiresAt"></label>
    <input asp-for="Input.ExpiresAt" type="datetime-local" />
    <span asp-validation-for="Input.ExpiresAt"></span>
    <br /><br />

    <button type="submit">Generate Link</button>
</form>

@if (!string.IsNullOrEmpty(Model.GeneratedUrl))
{
    <br />
    <input type="text" id="generatedUrl" value="@Model.GeneratedUrl" readonly style="width:100%" />
    <button type="button" onclick="copyLink()">Copy to Clipboard</button>
    <span id="copyStatus" style="display:none;color:green;">Link copied!</span>
}

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        function copyLink() {
            const input = document.getElementById('generatedUrl');
            input.select();
            navigator.clipboard.writeText(input.value);
            const status = document.getElementById('copyStatus');
            status.style.display = 'inline';
            setTimeout(() => status.style.display = 'none', 2000);
        }
    </script>
}